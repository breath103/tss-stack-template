#!/bin/sh

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR)

# Check if any backend files are staged
BACKEND_CHANGED=$(echo "$STAGED_FILES" | grep -E "^packages/backend/" || true)
if [ -n "$BACKEND_CHANGED" ]; then
  echo "Backend files changed, running lint --fix..."
  npm run lint -w backend -- --fix
  git add packages/backend/
fi

# Check if any frontend files are staged
FRONTEND_CHANGED=$(echo "$STAGED_FILES" | grep -E "^packages/frontend/" || true)
if [ -n "$FRONTEND_CHANGED" ]; then
  echo "Frontend files changed, running lint --fix..."
  npm run lint -w frontend -- --fix
  git add packages/frontend/
fi
